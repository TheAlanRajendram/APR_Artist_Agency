---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { marked } from 'marked';

// Get all services and sort by order
const services = await getCollection('services');
const sortedServices = services.sort((a, b) => a.data.order - b.data.order);

// Convert markdown to HTML for proper rendering
sortedServices.forEach(service => {
  service.compiledContent = marked.parse(service.body);
});
---

<BaseLayout title="Services">
  <section class="py-16 relative">
    <div class="container mx-auto px-4">
      <h1 class="text-4xl font-bold mb-12 text-center font-serif">Our Services At APR</h1>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {sortedServices.map((service) => (
          <div class="service-card bg-dark-card p-8 rounded-lg shadow-lg transition-transform hover:scale-105">
              <h2 class="text-2xl font-bold mb-4 text-gold font-serif">{service.data.title}</h2>

              <div class="prose prose-invert max-w-none" set:html={service.compiledContent} />
          </div>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .service-card {
    height: 100%;
    display: flex;
    flex-direction: column;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .markdown-content ul {
    margin-top: 1rem;
    list-style-type: disc;
    padding-left: 1.5rem;
  }

  .markdown-content li {
    margin-bottom: 0.5rem;
  }

  .markdown-content p {
    margin-bottom: 1rem;
    line-height: 1.6;
  }
</style>
