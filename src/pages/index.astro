---
import BaseLayout from "../layouts/BaseLayout.astro";
import BackgroundVideo from "../components/BackgroundVideo.astro";
import LazyImage from "../components/LazyImage.astro";
import LazyPage from "../components/LazyPage.astro";
import { getCollection } from "astro:content";

const base = import.meta.env.BASE_URL;

// Get work items
const workItems = await getCollection("work");
// Add base path to image URLs
const itemsWithBasePath = workItems.map((item) => ({
  ...item,
  data: {
    ...item.data,
    image: `${base}${item.data.image}`
  }
}));
// Use only 10 items for the featured carousel
const featuredItems = itemsWithBasePath.slice(0, 10);
---

<BaseLayout title="Home" transparentNavbar={true}>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/swiper@10.2.0/swiper-bundle.min.css"
  />

  <section
    class="relative py-20 md:py-36 bg-dark-lighter overflow-hidden hero-section"
  >
    <BackgroundVideo>
      <h1
        class="text-4xl md:text-4xl font-bold font-serif animate-fade-in text-center"
      >
        <span class="block mb-2 text-heading-secondary font-normal">CONNECTING</span>
        <span class="flex items-center justify-center">
          <span class="text-heading italic font-black">BRANDS</span>
          <span class="text-heading font-medium mx-4 mb-2">&times;</span>
          <span class="text-heading italic font-black">ARTISTS</span>
        </span>
      </h1>
      <p
        class="hidden md:block text-lg text-center text-secondary opacity-90 mt-12 mb-8 max-w-2xl animate-fade-in"
      >
        APR Artist Agency specializes in creating powerful partnerships between
        brands and exceptional talent across sports, music, and entertainment.
      </p>
      {/* Fluid Bounce Scroll Down Chevron for Desktop in Slot */}
      <div
        class="hidden md:block absolute bottom-20 inset-x-0 mx-auto w-10 z-10 animate-bounce-fluid"
      >
        <a
          href="#featured-section"
          aria-label="Scroll to featured collaborations"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-10 h-10 text-primary opacity-70"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m4.5 5.25 7.5 7.5 7.5-7.5m-15 6 7.5 7.5 7.5-7.5"></path>
          </svg>
        </a>
      </div>
    </BackgroundVideo>

    {
      /* Fluid Bounce Scroll Down Chevron for Mobile - Centered on Hero Section */
    }
    <div
      class="md:hidden absolute bottom-8 inset-x-0 mx-auto w-10 z-10 animate-bounce-fluid"
    >
      <a
        href="#featured-section"
        aria-label="Scroll to featured collaborations"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-10 h-10 text-primary opacity-70"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="m4.5 5.25 7.5 7.5 7.5-7.5m-15 6 7.5 7.5 7.5-7.5"></path>
          </svg>
        </a>
      </div>
    </section>

  <style>
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes bounce-fluid-effect {
      0%,
      100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px); /* Max bounce height */
      }
    }

    .animate-fade-in {
      animation: fadeIn 1s ease-out forwards;
    }

    .animate-fade-in-up {
      animation: fadeInUp 1s ease-out 0.3s forwards;
      opacity: 0; /* Start transparent for fadeInUp */
    }

    .animate-bounce-fluid {
      animation: bounce-fluid-effect 1.5s infinite ease-in-out;
    }

    .hero-section {
      margin-top: 0;
      min-height: 100svh;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    /* Swiper custom styles */
    .swiper {
      width: 100%;
      padding-bottom: 50px;
    }

    .swiper-slide {
      height: auto;
      transition: transform 0.3s;
    }

    .swiper-pagination-bullet {
      background: theme("colors.secondary.DEFAULT");
      opacity: 0.6;
    }

    .swiper-pagination-bullet-active {
      background: theme("colors.primary.DEFAULT");
      opacity: 1;
    }

    .swiper-button-next,
    .swiper-button-prev {
      color: theme("colors.primary.DEFAULT");
    }

    /* Styles for scrolling brand logos */
    .scrolling-row-wrapper {
      overflow: hidden;
      /* Optional: Add a mask for fading edges if desired. Requires vendor prefixes.
      -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
      mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
      */
    }

    .scrolling-row-inner {
      display: flex; /* Aligns brand items in a row */
      flex-shrink: 0; /* Prevents shrinking of the inner container */
    }

    .scroll-l-to-r { /* Content moves left, appears as scrolling left-to-right */
      animation: scroll-l-to-r-animation 40s linear infinite;
    }

    .scroll-r-to-l { /* Content moves right, appears as scrolling right-to-left */
      animation: scroll-r-to-l-animation 40s linear infinite;
    }

    @keyframes scroll-l-to-r-animation {
      0% {
        transform: translateX(0%);
      }
      100% {
        transform: translateX(-50%); /* Assumes content is duplicated once */
      }
    }

    @keyframes scroll-r-to-l-animation {
      0% {
        transform: translateX(-50%); /* Start "halfway" through the duplicated content */
      }
      100% {
        transform: translateX(0%); /* Scroll back to the beginning of the first set */
      }
    }

    .scrolling-row-inner:hover {
      animation-play-state: paused; /* Optional: Pause animation on hover */
    }

    .brand-item {
      /* Using Tailwind classes directly in HTML for this, e.g., w-28, shrink-0 */
    }
  </style>

  <LazyPage id="featured-section" rootMargin="300px 0px">
    <section class="py-8 bg-dark-lighter">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold mb-8 text-center font-serif text-heading-secondary">
          Featured Collaborations
        </h2>
        <div class="swiper portfolio-swiper">
          <div class="swiper-wrapper">
            {
              featuredItems.map((item) => (
                <div class="swiper-slide">
                  <a href={`${base}/work/${item.slug}`} class="block group">
                    <div class="bg-dark-card rounded-lg overflow-hidden h-full shadow-card transition-all">
                      <LazyImage
                        src={item.data.image}
                        alt={item.data.title}
                        class="w-full h-full object-cover"
                      />
                      <div class="p-6">
                        <h3 class="text-xl font-bold mb-2 font-serif group-hover:text-heading transition-colors text-heading-secondary">
                          {item.data.title}
                        </h3>
                        <p class="text-secondary mb-3">
                          {item.data.brand} <span class="inline-block text-primary align-middle text-lg">&times;</span> {item.data.artist}
                        </p>
                        <div class="flex flex-wrap gap-2">
                          <span class="bg-dark px-2 py-1 rounded-full text-xs text-secondary">
                            {item.data.tags[0]}
                          </span>
                          {item.data.tags[1] && (
                            <span class="bg-dark px-2 py-1 rounded-full text-xs text-secondary">
                              {item.data.tags[1]}
                            </span>
                          )}
                        </div>
                      </div>
                    </div>
                  </a>
                </div>
              ))
            }
          </div>
          <div class="swiper-pagination"></div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
        </div>
      </div>
    </section>
  </LazyPage>

  <section class="py-8 bg-dark">
    <div class="container mx-auto px-4">
      <div class="max-w-6xl mx-auto">
        <h2 class="text-3xl md:text-4xl font-bold mb-12 text-center font-serif text-heading-secondary">
          Our Network & Impact
        </h2>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
          <div class="text-center">
            <div class="text-4xl md:text-5xl font-bold text-heading-secondary mb-3">
              130+
            </div>
            <p class="text-secondary text-lg">Global A-List Talents</p>
          </div>
          <div class="text-center">
            <div class="text-4xl md:text-5xl font-bold text-heading-secondary mb-3">
              200+
            </div>
            <p class="text-secondary text-lg">Brand Partners</p>
          </div>
          <div class="text-center">
            <div class="text-4xl md:text-5xl font-bold text-heading-secondary mb-3">
              8+
            </div>
            <p class="text-secondary text-lg">Figure Commercial Deals</p>
          </div>
          <div class="text-center">
            <div class="text-4xl md:text-5xl font-bold text-heading-secondary mb-3">
              18+
            </div>
            <p class="text-secondary text-lg">Years Combined Experience</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  {/* MODIFIED: Trusted by Industry Leaders Section */}
  <section class="py-16 bg-dark-accent overflow-hidden"> {/* Added overflow-hidden and increased py */}
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-bold mb-12 text-center font-serif text-heading-secondary">
        Trusted by Industry Leaders
      </h2>
    </div>

    {/* Top row: scrolls content to the left (appears as LTR scroll) */}
    <div class="scrolling-row-wrapper py-3">
      <div class="scrolling-row-inner scroll-l-to-r flex">
        {/* Brands 1-8 (Example with 8 unique items per row, duplicated) */}
        {Array.from({ length: 8 }, (_, i) => (
          <div class="brand-item shrink-0 mx-4 py-2">
            <div class="h-10 w-32 bg-primary/20 rounded flex items-center justify-center px-4 filter grayscale hover:grayscale-0 transition-all duration-300 ease-in-out opacity-70 hover:opacity-100">
              <span class="text-sm text-on-primary font-medium">BRAND {i + 1}</span>
            </div>
          </div>
        ))}
        {/* Duplicate Brands 1-8 for seamless loop */}
        {Array.from({ length: 8 }, (_, i) => (
          <div class="brand-item shrink-0 mx-4 py-2">
            <div class="h-10 w-32 bg-primary/20 rounded flex items-center justify-center px-4 filter grayscale hover:grayscale-0 transition-all duration-300 ease-in-out opacity-70 hover:opacity-100">
              <span class="text-sm text-on-primary font-medium">BRAND {i + 1}</span>
            </div>
          </div>
        ))}
      </div>
    </div>

    {/* Bottom row: scrolls content to the right (appears as RTL scroll) */}
    <div class="scrolling-row-wrapper py-3">
      <div class="scrolling-row-inner scroll-r-to-l flex">
        {/* Brands 9-16 */}
        {Array.from({ length: 8 }, (_, i) => (
          <div class="brand-item shrink-0 mx-4 py-2">
            <div class="h-10 w-32 bg-primary/20 rounded flex items-center justify-center px-4 filter grayscale hover:grayscale-0 transition-all duration-300 ease-in-out opacity-70 hover:opacity-100">
              <span class="text-sm text-on-primary font-medium">BRAND {i + 9}</span>
            </div>
          </div>
        ))}
        {/* Duplicate Brands 9-16 for seamless loop */}
        {Array.from({ length: 8 }, (_, i) => (
          <div class="brand-item shrink-0 mx-4 py-2">
            <div class="h-10 w-32 bg-primary/20 rounded flex items-center justify-center px-4 filter grayscale hover:grayscale-0 transition-all duration-300 ease-in-out opacity-70 hover:opacity-100">
              <span class="text-sm text-on-primary font-medium">BRAND {i + 9}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
  {/* END OF MODIFIED SECTION */}

  <section class="py-8 bg-dark">
    <div class="container mx-auto px-4 text-center">
      <div class="max-w-3xl mx-auto">
        <h2 class="text-3xl md:text-4xl font-bold mb-6 font-serif text-heading">
          Ready to Create Something Extraordinary?
        </h2>
        <p class="text-lg text-secondary mb-8 leading-relaxed">
          Whether you're a brand seeking authentic partnerships or an artist
          looking for meaningful collaborations, we're here to make it happen.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a
            href={`${base}/contact`}
            class="border border-primary text-primary px-8 py-2 rounded-full hover:bg-primary hover:text-on-primary transition-colors font-medium text-lg"
          >
            Partner With Us
          </a>
          <a
            href={`${base}/work`}
            class="border border-primary text-primary px-8 py-2 rounded-full hover:bg-primary hover:text-on-primary transition-colors font-medium text-lg"
          >
            View Our Work
          </a>
        </div>
      </div>
    </div>
  </section>

  <script
    is:inline
    src="https://cdn.jsdelivr.net/npm/swiper@10.2.0/swiper-bundle.min.js"
  ></script>

  <script is:inline>
    document.addEventListener("astro:page-load", function () {
      new Swiper(".portfolio-swiper", {
        slidesPerView: 1,
        spaceBetween: 20,
        loop: true,
        centeredSlides: true,
        autoplay: {
          delay: 1500,
          disableOnInteraction: false
        },
        pagination: {
          el: ".swiper-pagination",
          clickable: true
        },
        navigation: {
          nextEl: ".swiper-button-next",
          prevEl: ".swiper-button-prev"
        },
        effect: "slide",
        speed: 600,
        breakpoints: {
          640: {
            slidesPerView: 2,
            spaceBetween: 20
          },
          1024: {
            slidesPerView: 3,
            spaceBetween: 30
          }
        }
      });
    });
  </script>
</BaseLayout>
 
