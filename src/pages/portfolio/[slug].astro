---
import { getCollection } from 'astro:content';
import PortfolioDetailLayout from '../../layouts/PortfolioDetailLayout.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import type { CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const portfolioItems = await getCollection('portfolio');
  return portfolioItems.map(item => ({
    params: { slug: item.slug },
    props: { item },
  }));
}

const { item } = Astro.props as { item: CollectionEntry<'portfolio'> };
const { Content } = await item.render();
const base = import.meta.env.BASE_URL;

// Add base path to the image URL
const itemData = {
  ...item.data,
  image: `${base}${item.data.image}`
};
---

<BaseLayout title={item.data.title}>
  <PortfolioDetailLayout {...itemData}>
    <div class="prose prose-invert prose-headings:font-serif prose-headings:text-white prose-p:text-gray-300 prose-strong:text-white prose-a:text-gold hover:prose-a:text-gold/80 prose-blockquote:text-gray-300 prose-blockquote:border-l-gold">
      <Content />
    </div>
  </PortfolioDetailLayout>
</BaseLayout>
