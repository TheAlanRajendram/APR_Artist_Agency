---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const portfolioItems = await getCollection("portfolio");
const base = import.meta.env.BASE_URL;

// Add base path to image URLs
const itemsWithBasePath = portfolioItems.map((item) => ({
  ...item,
  data: {
    ...item.data,
    image: `${base}${item.data.image}`
  }
}));
---

<BaseLayout title="Portfolio">
  <section class="py-20">
    <div class="container mx-auto px-4">
      <h1 class="text-4xl font-bold mb-12 text-center font-serif">
        Our Portfolio
      </h1>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {
          itemsWithBasePath.map((item) => (
            <a href={`${base}/portfolio/${item.slug}`} class="group">
              <div class="bg-dark-card rounded-lg overflow-hidden shadow-card transition-transform group-hover:scale-105">
                <img
                  src={item.data.image}
                  alt={item.data.title}
                  class="w-full h-full object-cover"
                />
                <div class="p-6">
                  <h2 class="text-xl font-bold mb-2 group-hover:text-gold transition-colors font-serif">
                    {item.data.title}
                  </h2>
                  <p class="text-white opacity-50 mb-4">
                    {item.data.brand} Ã— {item.data.artist}
                  </p>
                  <div class="flex flex-wrap gap-2">
                    {item.data.tags.map((tag) => (
                      <span class="bg-dark px-2 py-1 rounded-full text-sm text-white opacity-50">
                        {tag}
                      </span>
                    ))}
                  </div>
                </div>
              </div>
            </a>
          ))
        }
      </div>
    </div>
  </section>
</BaseLayout>
