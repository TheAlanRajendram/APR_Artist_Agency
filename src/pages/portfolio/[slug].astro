---
import { getCollection } from 'astro:content';
import PortfolioDetailLayout from '../../layouts/PortfolioDetailLayout.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const portfolioItems = await getCollection('portfolio');
  return portfolioItems.map(item => ({
    params: { slug: item.slug },
    props: { item },
  }));
}

const { item } = Astro.props;
const { Content } = await item.render();
const base = import.meta.env.BASE_URL;

// Add base path to the image URL
const itemData = {
  ...item.data,
  image: `${base}${item.data.image}`
};
---

<BaseLayout title={item.data.title}>
  <PortfolioDetailLayout {...itemData}>
    <Content />
  </PortfolioDetailLayout>
</BaseLayout>
